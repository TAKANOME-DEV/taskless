# Taskless JS Client API Reference

## Taskless Data Format

A request generated by the Taskless Client results in the following payload:

```ts
type TasklessBody = {
  /** The Taskless Body Version which describes the top-level keys expected */
  v: 1;
  /** The encoder transport */
  transport: {
    /** The transport envelope version which describes the transport keys and any envelope schema on the text object */
    ev: 1;
    /** The Cipher algorithym used */
    alg: "aes-256-gcm" | "none";
    /** The length of the Auth Tag. Required if supported in Cipher */
    atl?: number;
    /** The Auth Tag. Required if supported in Cipher */
    at?: string;
    /** The Cipher IV value. Required if supported in Cipher */
    iv?: string;
  };
  /** Possibly ciphered text, based on transport settings */
  text: string;
  /** Signature of TasklessBody.text computed using your app's secret */
  signature: string;
};
```

## Encrypting Requests

By default, Taskless will encrypt requests sent to it using `aes-256-gcm` using the encryption key either set in `process.env.TASKLESS_ENCRYPTION_KEY` or passed into Queue construction as `options.encryptionKey`. Details about how the data was encrypted are made available in the body's `transport` property. If the request was not encrypted, the `transport.alg` field will be set to `"none"`, and the values for `atl`, `at`, and `iv` can be safely ignored.

In Version `1` of the transport envelope, `at`, `iv`, and `text` are assumed to be Base64 encoded.

## Signing Requests

Regardless of encryption, all requests from Taskless are signed using your application secret (either passed into the Queue as `options.credentials.secret` or set in `process.env.TASKLESS_APP_SECRET`). In Version `1` of `TasklessBody` this signature is a `sha256` computed using the following and encoded as a `base64` string.

```ts
export const sign = (input: string, secret: string): string => {
  return createHmac("sha256", secret).update(input).digest("base64");
};
```
